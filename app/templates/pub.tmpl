{% extends "base.tmpl" %}

{% macro entity_group(name, entities) %}
    <div class="entity_group">
        <h2>{{ name }}</h2>
        {% if not entities %}
            None
        {% else %}
            <div class="entities">
                {% for e in entities.itervalues() %}
                    {{ entity(e) }}
                {% endfor %}
            </div>
        {% endif %}
    </div>
{% endmacro %}

{% macro entity(ent) %}
    <div class="entity">
        <div class="ent_id">{{ ent.id }}</div>
        {% for error in ent.errors %}
            <div class="error">{{ error.render() }}</div>
        {% endfor %}
        {% for warning in ent.warnings %}
            <div class="warning">{{ warning.render() }}</div>
        {% endfor %}
        <ul class="fields">
            {% for (an, _, display) in ent.attributes %}
                <li>{{ display }}: {{ ent.display_value(an) }}</li>
            {% endfor %}
        </ul>
        <div class="annot_links">
            Annotations
            {% for annot_link in ent.annotation_links() %}
                <br/>
                {{ annot_link }}
            {% endfor %}
        </div>
    </div>
{% endmacro %}

{% block title %}PMC {{ pub.pmc_id }} - CANDI Share Publication Portal{% endblock %}

{% block body %}

<div id="pub_link">
PMC ID <a href="http://via.hypothes.is/http://www.ncbi.nlm.nih.gov/pmc/articles/{{ pub.pmc_id }}">{{ pub.pmc_id }}</a>.
</div>

<div id="summary">
    {% if pub.errors %}
        <h2>Errors</h2>
        {% for error in pub.errors %}
            <p>{{ error.render() }}</p>
        {% endfor %}
    {% endif %}
</div>

{{ entity_group('Subject Groups', pub.subjectgroups) }}

{{ entity_group('Acquisition Instruments', pub.acquisitioninstruments) }}

{{ entity_group('Acquisitions', pub.acquisitions) }}

{{ entity_group('Data', pub.data ) }}

{{ entity_group('Analysis Workflows', pub.analysisworkflows) }}

{{ entity_group('Observations', pub.observations) }}

{{ entity_group('Models', pub.models) }}

{{ entity_group('Model Applications', pub.modelapplications) }}

{{ entity_group('Results', pub.results) }}

{% endblock %}
